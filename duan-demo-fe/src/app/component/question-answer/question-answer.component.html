<div class="container-fluid">
    <div *ngIf="isLoading" class="loading">
        <div class="spinner-border text-primary spinner-center" role="status">
        </div>
    </div>
    <div class="row clearfix">
        <div>
            <!-- <div class="card chat-app"> -->
            <div class="" style="padding-left: 70px; padding-right: 70px; padding-bottom: 50px;">




                <!-- <div id="plist" class="people-list">
                <div [formGroup]="form">
                    <div class="upload-file" (keydown.enter)="file.click()" >
                        <input #file type="file"  id="upload-file" style="display: none;" 
                                (change)="upload(file.files); importFile()">
                        <label for="upload-file"  tabindex="0" class="index-focus file i-btn"
                        style="width: auto; padding: 7px 15px;    
                                background: #308ee0;
                                color: white;
                                font-size: 15px;">
                            <svg xmlns="http://www.w3.org/2000/svg"  style="fill: white;"  height="16" width="14" viewBox="0 0 448 512">
                                <path d="M246.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 109.3V320c0 17.7 14.3 32 32 32s32-14.3 32-32V109.3l73.4 73.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-128-128zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v64c0 53 43 96 96 96H352c53 0 96-43 96-96V352c0-17.7-14.3-32-32-32s-32 14.3-32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V352z"/>
                            </svg>
                            Tải file 
                        </label>
                    </div>
                    <div style="margin-top: 15px;">
                        <span>
                            {{fileName}}
                        </span>
                    </div>
                    <div>
                        <button class="btn btn-success" 
                            style="margin-top: 10px;width: 91px;">
                            Clear
                        </button>
                    </div>
                </div>
              </div> -->



                <div class="chat">
                    <div class="chat-header clearfix" style="margin-left: 150px;">

                        <div class="row">
                            <!-- <div class="mb-3">
                                <label for="exampleFormControlInput1" class="form-label">System</label>
                                <input type="text" [(ngModel)]="chatRequest.system" class="form-control" id="exampleFormControlInput1"
                                    style="width: 740px;" placeholder="">
                            </div> -->
                            <div class="mb-3">
                                <textarea class="form-control" 
                                    [(ngModel)]="chatRequest.system"
                                    placeholder="System" 
                                    style="height: 100px; width: 1200px;">
                                </textarea>
                            </div>
                        </div>

                        <div style="display: flex;">
                            <div class="upload-file" (keydown.enter)="file.click()" style="display: flex; flex-direction: column;">
                                <input #file type="file" id="upload-file" style="display: none;"
                                    (change)="upload(file.files); importFile()">
                                <label for="upload-file" tabindex="0" class="index-focus file i-btn" style="width: auto; padding: 7px 15px;    
                                    background: #308ee0;
                                    color: white;
                                    font-size: 15px;">
                                    <svg xmlns="http://www.w3.org/2000/svg" style="fill: white;" height="16" width="14"
                                        viewBox="0 0 448 512">
                                        <path
                                            d="M246.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 109.3V320c0 17.7 14.3 32 32 32s32-14.3 32-32V109.3l73.4 73.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-128-128zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v64c0 53 43 96 96 96H352c53 0 96-43 96-96V352c0-17.7-14.3-32-32-32s-32 14.3-32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V352z" />
                                    </svg>
                                    Tải file
                                </label>
                                <button class="btn btn-success" style="margin-top: 5px;">
                                    Clear
                                </button>
                            </div>
                            <div style="margin-left: 50px;">
                                <!-- <input type="text" [(ngModel)]="chatRequest.context" 
                                    class="form-control" id="exampleFormControlInput1"
                                    style="width: 600px;" placeholder="Nếu không upload thì gõ text"> -->
                          
                                <textarea class="form-control" 
                                    [(ngModel)]="chatRequest.context" 
                                    placeholder="Nếu không upload thì gõ text" 
                                    style="height: 78px; width: 1059px;">
                                </textarea>
                            </div>
                        </div>
                    </div>

                    <div class="chat-header clearfix row">
                        <div style="display: flex; justify-content: space-between;
                        padding: 8px;">
                          <div class="col-lg-3">
                              <a href="javascript:void(0);" data-toggle="modal" data-target="#view_info">
                                  <img src="https://bootdey.com/img/Content/avatar/avatar2.png" alt="avatar">
                              </a>
                              <div class="chat-about">
                                  <h6 class="m-b-0" style="font-size: 25px;">{{username}}</h6>
                                  <small>Last seen: 2 hours ago</small>
                              </div>
                          </div>

                          <div class="col-lg-3">
                              <label for="" style="margin-bottom: 10px;">Lựa chọn Model</label>
                              <ng-select
                              [items]="listModel"
                              placeholder="Lựa chọn"
                              [(ngModel)]="chatRequest.model"
                              class="input-select"
                              bindLabel="name"
                              bindValue="name"
                              [searchable]="false"
                              [clearable]="false"
                              style="width: 200px;"
                              >
                              </ng-select>
                          </div>
                      </div>
                    </div>
                    <!-- body -->
                    <div class="chat-history" id="scroll">
                        <ul class="m-b-0" style="height: 550px;overflow: scroll;" #scrollframe1>

                            <li class="clearfix" *ngFor="let item of listMessage" #item1>
                                <div class="message-data text-right" style="display: flex;
                              align-items: center;">
                                    <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="avatar">
                                    <div style="font-size: 15px; text-transform: uppercase;">YOU</div>
                                </div>
                                <div class="message other-message" style="margin-right: 20px;">
                                    <span style="float: inline-start;">{{item.contentRequest}}</span>
                                </div>
                                <div style="margin-top: 50px;">
                                    <div class="message-data text-right">
                                        <span class="message-data-time">{{item.createTime | date:'dd-MM-yyyy'}}</span>
                                        <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="avatar">
                                        <div style="font-size: 15px; text-transform: uppercase;">{{item.roleChoices}}
                                        </div>
                                    </div>
                                    <div class="message my-message" style="white-space: break-spaces;">
                                        {{item.contentResponse}}
                                    </div>
                                </div>

                            </li>
                        </ul>
                    </div>
                    <!-- body -->

                    <div class="chat-message clearfix">
                        <div class="input-group mb-0">
                            <input type="text" class="form-control" [(ngModel)]="chatRequest.content"
                                placeholder="Enter text here..." (keyup.enter)="sendChatBox()">
                            <div class="input-group-prepend" (click)="sendChatBox()">
                                <span class="input-group-custom">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="16" width="16"
                                        viewBox="0 0 512 512">
                                        <path
                                            d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z" />
                                    </svg>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>




            </div>
        </div>
    </div>
</div>